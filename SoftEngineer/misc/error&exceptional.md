# 错误与异常
本文受众：
- 软件从业人员
- 系统架构设计人员
文章内容：
在脱离具体的编程语言的前提下，讨论错误与异常的区别。
## 我理解的错误与异常
将运行的软件系统看为一个整体，开发人员期望系统按照预期稳定运行（可视为某个层级的事务一致性），但系统运行过程中往往受到输入和环境的扰动，导致系统中出现广义错误。
本文将广义错误定义为系统在某个执行层级出现非预期的情况，但由于当前层级的信息缺失\权限不足等原因而无法处理的状态。（注意与下文的错误区分）
为保证系统继续按预期运行，遇到广义错误时，需要将错误信息上报给能处理错误（忽视错误也是一种处理手段）的更高层级。（这里更高层级包括上报给系统使用人员，甚至说系统使用人员继续上报其领导）
从本质上来说，依据如何上报广义错误，我们可以将广义错误分为以下两种：
- 自主实现错误信息逐级上报逻辑的是错误(error)
- 自动回溯调用栈的是异常(exception)

两者在形式上也有区别，但实现上可以互相转化
- 错误：在各种编程语言中都可以实现，常见是以函数返回值的形式，也有以参数透传的形式向更上层级上报传递。
- 异常：通常需要编程语言的支持，大多以异常对象的形式存在，以try-catch语法在可处理的层级捕获下层的异常。

究其原因，两者形式上的区别源自与不同的设计思路，将广义错误也视为系统接口的一部分：
- 错误脱离编程语言，强调开发人员设计这套错误集合，这套集合的使用范围非常灵活，可以是模块内部自用的，也可以是跨模块的，比如操作系统实现的错误码。
- 异常在编程语言之上，将广义错误集合融入到了各个层级的模块接口中，像函数签名，定义模块的同时就定义了异常集合，其范围是和模块层级绑定的。

这么看来异常像是一种错误处理的语法糖。但这种语法糖的产生来自于在多数情况下，广义错误的来源是无法预料的，导致错误集合的设计是非常复杂的。连语法糖也无法完全解决这个问题。

## ref
https://learn.microsoft.com/zh-cn/cpp/cpp/errors-and-exception-handling-modern-cpp?view=msvc-170
https://www.zhihu.com/question/36278363/answer/67013226